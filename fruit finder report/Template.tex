% Template for ICME-2010 paper; to be used with:
%          spconf.sty  - ICASSP/ICIP LaTeX style file, and
%          IEEEbib.bst - IEEE bibliography style file.
% --------------------------------------------------------------------------
\documentclass{article}
\usepackage{spconf_ICME,amsmath,epsfig,fancyhdr}
\setlength{\paperwidth}{215.9mm} \setlength{\hoffset}{-9.7mm}
\setlength{\oddsidemargin}{0mm} \setlength{\textwidth}{184.3mm}
\setlength{\columnsep}{6.3mm} \setlength{\marginparsep}{0mm}
\setlength{\marginparwidth}{0mm} \setlength{\paperheight}{279.4mm}
\setlength{\voffset}{-7.4mm} \setlength{\topmargin}{0mm}
\setlength{\headheight}{0mm} \setlength{\headsep}{0mm}
\setlength{\topskip}{0mm} \setlength{\textheight}{235.2mm}
\setlength{\footskip}{12.4mm} \setlength{\parindent}{1pc}


\ICMEfinalcopy % *** Uncomment this line for the final submission

\def\ICMEPaperID{****} % *** Enter the ICME Paper ID here
\def\httilde{\mbox{\tt\raisebox{-.5ex}{\symbol{126}}}}

% Pages are numbered in submission mode, and unnumbered in camera-ready
\ifICMEfinal\pagestyle{empty}\fi


\begin{document}\sloppy

% Example definitions.
% --------------------
\def\x{{\mathbf x}}
\def\L{{\cal L}}


% Title.
% ------
\title{AN APPLICATION FOR FINDING AND CLASSIFYING FRUIT IN IMAGES}
%
% Single address.
% ---------------
\name{Eric Henderson and Nick Kamper}
\address{Rose-Hulman Institute of Technology}


\maketitle
% insert page header and footer here for IEEE PDF Compliant
\thispagestyle{fancy} \fancyhead{} \lhead{}
%\lfoot{978-1-4244-7493-6/10/\$26.00~\copyright2010 IEEE} \cfoot{}
%\rfoot{ICME 2010}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}




%
\begin{abstract}

\end{abstract}
%
\begin{keywords}
image classification,thresholding,median filtering
\end{keywords}
%
\section{Introduction}
\label{sec:intro}

The subject of this paper is an application that will find and classify fruit in a given set of images.
The fruits supported are \textbf{apples}, \textbf{bananas}, and \textbf{oranges}.


\section{Process}
\label{sec:process}
\subsection{Overview}
\label{subsec:process:overview}

The first step in finding the fruit is to convert the image to the HSV image space.  Then, simple thresholding is used to remove the background from the image.  Next, thresholding is used again, but this time to find individual types of fruit.  These initial fruit masks are enhanced by using morphological operators, such as erosion and dilation, as well as a median filter.  After obtaining a mask of each fruit, connected objects can be used to find separate pieces of fruit.  To filter out any noise that may have gotten past the filtering, the area of each connected region is computed in order to determine any outliers.  These outliers are then removed.  Finally, the centroid of each piece of fruit and the number of pieces of each type are calculated.

\subsection{Thresholding}
Our technique involves using two different levels of thresholding: a threshold to remove the background of the image and then a set of thresholds to find the different fruits. This technique allows the foreground filters (for finding the fruits) to be less selective, as those filters will not have to deal with false-positives in the background.

\subsection{Enhancing the mask}
After thresholding, there is a rough mask of the area where the fruit is. However, these masks contain a significant amount of noise. Our technique uses two methods to reduce the impact of this noise prior to finding regions: a median filter and morphological operations. 

First, a median filter, using a 5x5 square, is applied. The median filter is suitable for ``salt and pepper" noise, which we determined was one of the more common types of noise seen in thresholded images. Next, a morphological close operation, consisting of an erosion and dilation, is applied to the image using a 3x3 diamond, equivalent to a four-neighborhood. After these operations, the mask is relatively free of major noise and holes.

\subsection{Finding connected regions}
After the mask is enhanced, our technique will find the connected regions within the image using MATLAB's \texttt{bwlabel} using a four-neighborhood. \texttt{bwlabel} returns a matrix consisting of 0, 1, ..., n in each cell, corresponding to the regions. These regions are then split up into individual masks and normalized into binary masks. 

\subsection{Removing more noise}
At this point, each mask contains a single connected region. However, there are still some regions that correspond to noise in the mask. To reduce this noise further, our technique will then calculate the average area of each mask and removes those masks which has an area significantly smaller or larger than the average region size. This concludes the processing of the masks by our technique. 

\section{Training data}
\subsection{Thresholding values}
\label{subsec:process:filters}
\subsubsection{Background capturing thresholds}
\label{subsubsec:process:filters:background}
~\\
\textbf{Filter 1}
\[0.000 <= H <= 1.000\]
\[0.275 <= S <= 0.425\]
\[0.100 <= V <= 0.450\]\\
~
\textbf{Filter 2}
\[0.150 <= H <= 0.450\]
\[0.000 <= S <= 0.900\]
\[0.000 <= V <= 0.225\]\\
~
\textbf{Filter 3}
\[0.100 <= H <= 0.275\]
\[0.125 <= S <= 0.350\]
\[0.000 <= V <= 1.000\]\\

\subsubsection{Fruit capturing thresholds}
\label{subsubsec:process:filters:fruit}
~\\
\textbf{Apple}
\[0.925 <= H\ \textbf{OR}\ H <= 0.100\]
\[0.600 <= S <= 1.000\]
\[0.050 <= V <= 0.500\]\\
~
\textbf{Banana}
\[0.120 <= H <= 0.250\]
\[0.500 <= S <= 1.000\]
\[0.450 <= V <= 1.000\]\\
~
\textbf{Orange}
\[0.060 <= H <= 0.110\]
\[0.600 <= S <= 1.000\]
\[0.500 <= V <= 0.950\]\\

\subsection{Filters and Morphological Operators}
\label{subsec:process:filtmorph}
\begin{enumerate}
\item Median filter using a 5x5 square
\item Close operator using a 3x3 diamond (equivalent to four-neighborhood)
\end{enumerate}


\end{document}
